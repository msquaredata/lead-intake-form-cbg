<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="assets/styles/main.css">
  <title>Charlton Bleecker — Deal Prospect Intake</title>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="logo">CB</div>
        <div>
          <h1>Charlton Bleecker</h1>
          <p>Acquiring, scaling & operating enduring businesses</p>
        </div>
      </div>
      <nav class="nav">
        <a class="btn" href="#">Submit a Deal</a>
      </nav>
    </div>
  </div>

  <main class="container">

    <section class="grid grid-5">
      <div class="hero">
        <h2>Deal Prospect Intake</h2>
        <p>Share a concise snapshot of the opportunity. Estimates are fine. This helps us quickly determine fit and get you a fast, thoughtful response.</p>
        <div class="bullets">
          <div class="bullet"><div class="tick">✓</div> 5–7 min</div>
          <div class="bullet"><div class="tick">✓</div> Secure & confidential</div>
          <div class="bullet"><div class="tick">✓</div> Owner or advisor friendly</div>
          <div class="bullet"><div class="tick">✓</div> CRM-ready fields</div>
        </div>
      </div>
    </section>

    <section class="card shell">
      <div class="formgrid">
        <aside class="rail">
          <h4>Sections</h4>
          <ol>
            <li><span class="num">1</span> Contact</li>
            <li><span class="num">2</span> Business</li>
            <li><span class="num">3</span> Ownership</li>
            <li><span class="num">4</span> Financials</li>
            <li><span class="num">5</span> Fit</li>
            <li><span class="num">6</span> Files</li>
          </ol>

          <div class="why">
            <strong>Why we ask</strong><br>
            We use this info to route the deal to the right partner and respond quickly. High-level numbers are fine.
          </div>

          <div class="aside">
            <h3>What we look for</h3>
            <ul>
              <li>Durable cash flows, recurring or reoccurring revenue</li>
              <li>Strong teams seeking succession or growth support</li>
              <li>Lower middle market, $2M–$50M revenue (flexible)</li>
              <li>Business services, industrials, healthcare, consumer</li>
            </ul>
            <div class="note">If you have a teaser/CIM, add it at the end. If not, quick bullet points are perfect.</div>
          </div>
        </aside>

        <form id="leadForm" action="https://msquaresolutions.app.n8n.cloud/webhook-test/lead-intake" method="POST">

          <div>
            <div class="section-title">
              <span>1 · Contact Information</span>
              <span class="muted">Owner or advisor can submit</span>
            </div>
            <div class="row cols-2">
              <label><span>First Name</span><input type="text" name="firstName" placeholder="Jane" required></label>
              <label><span>Last Name</span><input type="text" name="lastName" placeholder="Doe" required></label>
              <label><span>Role / Relationship</span>
                <select name="role" required>
                  <option>Owner</option><option>Accountant</option><option>Advisor</option><option>Attorney</option><option>Broker</option><option>Executive</option><option>Other</option>
                </select>
              </label>
              <label><span>Email</span><input type="email" name="email" placeholder="you@company.com" required></label>
              <label><span>Phone</span><input type="tel" name="phone" placeholder="(555) 000-1234"></label>
              <label class="full"><span>Company Represented (if not owner)</span><input type="text" name="companyRepresented" placeholder="Acme Advisors, LLC"></label>
            </div>
          </div>

          <div>
            <div class="section-title"><span>2 · Business Profile</span></div>
            <div class="row cols-2">
              <label><span>Business Name</span><input type="text" name="businessName" placeholder="Acme Services, Inc."></label>
              <label><span>Website</span><input type="url" name="website" placeholder="https://example.com"></label>

              <div class="field-group">
                <span>Industry / Sector</span>
                <div class="multiselect-dropdown" data-name="industry">
                  <button type="button" class="dropdown-btn" data-dropdown="industry">Select industries</button>
                  <div class="dropdown-list">
                    <label><input type="checkbox" value="Business Services"> Business Services</label>
                    <label><input type="checkbox" value="Defense"> Defense</label>
                    <label><input type="checkbox" value="Energy"> Energy</label>
                    <label><input type="checkbox" value="Financial Services"> Financial Services</label>
                    <label><input type="checkbox" value="Healthcare"> Healthcare</label>
                    <label><input type="checkbox" value="Industrial / Trades"> Industrial / Trades</label>
                    <label><input type="checkbox" value="Consumer"> Consumer</label>
                    <label><input type="checkbox" value="Technology"> Technology</label>
                    <label><input type="checkbox" value="Other"> Other</label>
                  </div>
                </div>
              </div>

              <label><span>Headquarters (City, State)</span><input type="text" name="hq" placeholder="Fort Lauderdale, FL"></label>
              <label><span>Year Founded</span><input type="number" name="yearFounded" placeholder="1998"></label>
            </div>
          </div>

          <div>
            <div class="section-title"><span>3 · Ownership & Transition</span></div>
            <div class="row cols-2">
              <label><span>Current Ownership</span>
                <select name="ownership">
                  <option>Founder / Family-Owned</option><option>Partnership</option><option>Private Company</option><option>PE-Backed</option><option>Other</option>
                </select>
              </label>
              <label><span>Transition Goal</span>
                <select name="transitionGoal">
                  <option>Exit</option><option>Growth Capital</option><option>Partial Sale / Recap</option><option>Strategic Partnership</option>
                </select>
              </label>
              <label><span>Transition Timing</span>
                <select name="transitionTiming">
                  <option>Immediate</option><option>< 12 months</option><option>1–3 years</option><option>3+ years</option>
                </select>
              </label>
            </div>
          </div>

          <div>
            <div class="section-title"><span>4 · Financial Snapshot (Estimates OK)</span></div>
            <div class="row cols-3">
              <label><span>Annual Revenue</span>
                <select name="revenue">
                  <option>< $2M</option><option>$2–5M</option><option>$5–10M</option><option>$10–25M</option><option>$25M+</option>
                </select>
              </label>
              <label><span>EBITDA Margin</span>
                <select name="ebitdaMargin">
                  <option>< 5%</option><option>5–10%</option><option>10–20%</option><option>20%+</option>
                </select>
              </label>
              <label><span>Debt / Leverage</span>
                <select name="leverage">
                  <option>None</option><option>Manageable</option><option>Heavily Leveraged</option><option>Prefer not to say</option>
                </select>
              </label>
            </div>

            <div class="row cols-2">
              <label><span>Key Assets</span>
                <div class="chips">
                  <label class="chip"><input type="checkbox" name="assets" value="Real Estate"> Real Estate</label>
                  <label class="chip"><input type="checkbox" name="assets" value="Contracts"> Contracts</label>
                  <label class="chip"><input type="checkbox" name="assets" value="Goodwill/Brand"> Goodwill/Brand</label>
                  <label class="chip"><input type="checkbox" name="assets" value="IP/Patents"> IP/Patents</label>
                  <label class="chip"><input type="checkbox" value="Equipment"> Equipment</label>
                  <label class="chip"><input type="checkbox" value="Team"> Team</label>
                  <label class="chip"><input type="checkbox" value="Technology"> Technology</label>
                  <label class="chip"><input type="checkbox" value="Other"> Other</label>
                </div>
              </label>

              <label><span>Notable Customers or Contracts (optional)</span>
                <textarea name="notableCustomers" placeholder="e.g., multi-year maintenance contracts; preferred vendor to X"></textarea>
              </label>
            </div>
          </div>

          <div>
            <div class="section-title"><span>5 · Strategic Fit</span></div>
            <div class="row">
              <label><span>Why is this a strong fit for Charlton Bleecker?</span>
                <textarea name="fitReason" placeholder="Quick pitch: durable cash flows, succession opportunity, strong moat, growth vectors, etc."></textarea>
              </label>

              <div class="row cols-2">
                <div class="field-group">
                  <span>Biggest Current Challenge</span>
                  <div class="multiselect-dropdown" data-name="challenge">
                    <button type="button" class="dropdown-btn" data-dropdown="challenge">Select challenges</button>
                    <div class="dropdown-list">
                      <label><input type="checkbox" value="Succession Planning"> Succession Planning</label>
                      <label><input type="checkbox" value="Debt"> Debt</label>
                      <label><input type="checkbox" value="Growth Capital"> Growth Capital</label>
                      <label><input type="checkbox" value="Capital Structure"> Capital Structure</label>
                      <label><input type="checkbox" value="Operational Efficiency"> Operational Efficiency</label>
                      <label><input type="checkbox" value="Market Pressure / Competition"> Market Pressure / Competition</label>
                      <label><input type="checkbox" value="Overdue Bills"> Overdue Bills</label>
                      <label><input type="checkbox" value="Other"> Other</label>
                    </div>
                  </div>
                </div>
                <label style="flex-direction:row; align-items:center; gap:10px; margin-top:6px;">
                  <input type="checkbox" name="hasManagementTeam"> <span>Experienced management team in place</span>
                </label>
              </div>
            </div>
          </div>

          <div>
            <div class="section-title"><span>6 · Files & Extras</span></div>
            <div class="row cols-2">
              <label><span>Upload Teaser / CIM / Deck (optional)</span>
                <div class="drop">Drag & drop files here or <strong>browse</strong></div>
              </label>
              <label><span>How did you hear about us?</span>
                <select name="referralSource">
                  <option>Referral</option><option>Website</option><option>Event</option><option>Other</option>
                </select>
              </label>
            </div>
          </div>

          <div class="submitbar">
            <span class="muted">By submitting, you agree to our confidentiality & data use terms.</span>
            <div style="display:flex; gap:10px;">
              <button type="button" class="btn secondary">Save Draft</button>
              <button type="submit" class="btn">Submit Opportunity</button>
            </div>
          </div>
        </form>
      </div>
    </section>

    <footer>© 2025 Charlton Bleecker Group LLC — All rights reserved.</footer>
  </main>

<script>
document.addEventListener("DOMContentLoaded", () => {

  /* ======= Initialize custom multiselect dropdowns (CORRECT LOCATION) ======= */
  document.querySelectorAll(".multiselect-dropdown").forEach(dropdown => {
    const button = dropdown.querySelector(".dropdown-btn");
    const list = dropdown.querySelector(".dropdown-list");
    const hiddenInput = document.createElement("input");
    hiddenInput.type = "hidden";
    hiddenInput.name = dropdown.dataset.name;
    dropdown.appendChild(hiddenInput);

    // Get the original default text content from the button
    const defaultText = button.textContent.trim();

    // Function to update selected values and button text
    const updateDropdown = () => {
        const selected = Array.from(list.querySelectorAll("input:checked")).map(cb => cb.value);
        hiddenInput.value = selected.join(", ");
        
        let newText;
        if (selected.length === 0) {
            newText = defaultText;
            button.classList.remove('has-selection');
        } else if (selected.length === 1) {
            newText = selected[0];
            button.classList.add('has-selection');
        } else {
            newText = `${selected.length} items selected`;
            button.classList.add('has-selection');
        }
        
        // Use textContent to only update the text, preserving the ::after arrow
        button.textContent = newText;
    };
    
    // Initial update
    updateDropdown();

    // The primary click handler: Toggles the 'open' class on the parent dropdown
    button.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      // THIS IS THE CRITICAL LINE: TOGGLE 'open' on the parent div
      dropdown.classList.toggle("open");
    });

    // update selected values
    list.querySelectorAll("input[type='checkbox']").forEach(cb => {
      cb.addEventListener("change", updateDropdown);
    });

    // close dropdown on outside click
    document.addEventListener("click", (e) => {
      if (!dropdown.contains(e.target)) {
        dropdown.classList.remove("open");
      }
    });
  });

  /* ======= Handle form submission (Maintains submission logic) ======= */
  const form = document.getElementById("leadForm");
  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const button = form.querySelector("button[type='submit']");
    button.disabled = true;
    button.textContent = "Submitting...";

    const formData = new FormData(form);
    const formObject = Object.fromEntries(formData.entries());

    // Include multiselect values into the JSON payload
    document.querySelectorAll(".multiselect-dropdown input[type='hidden']").forEach(input => {
        formObject[input.name] = input.value;
    });

    try {
      const response = await fetch(form.action, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formObject),
      });

      const data = await response.json();

      if (response.ok && data.status === "received") {
        const redirectURL = data.redirect || "thank-you.html";
        setTimeout(() => (window.location.href = redirectURL), 800);
      } else {
        alert("Submission failed. Please try again.");
        button.disabled = false;
        button.textContent = "Submit Opportunity";
      }
    } catch (error) {
      console.error("Error submitting form:", error);
      alert("Unable to connect to the server. Please try again later.");
      button.disabled = false;
      button.textContent = "Submit Opportunity";
    }
  });

});
</script>
</body>
</html>